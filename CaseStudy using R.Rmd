---
title: "Case Study: How does a bike-share navigate speedy success?"
author: "Chantelle Gayle Astadan"
date: "2025-01-23"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction
The Cyclistic bike-share analysis is a case study that demonstrates the steps of the data analysis process: **Ask, Prepare, Process, Analyze, Share,** and **Act**. I analyzed the bike trip data of Cyclistic, a fictional bike-share company in Chicago, to identify how a bike-share navigates speedy success using the R programming language.   

## Scenario
I am a junior data analyst working on the marketing team at Cyclistic. Lily Moreno, director of marketing and my manager, believes the company's future success depends on maximizing the number of annual memberships. Therefore, our team wants to understand how casual riders and annual members use Cyclistic bikes differently. 

## Ask
**Business Task:** How do annual members and casual riders use Cyclistic bikes differently?

**Key Stakeholders:**

* Lily Moreno - Director of Marketing Team
* Cyclistic Executive Team

## Prepare
For this project, I downloaded the Cyclistic historical trip data for January 2024 to December 2024 [here](https://divvy-tripdata.s3.amazonaws.com/index.html). The data has been made available by Motivate International Inc. under this [license](https://divvybikes.com/data-license-agreement). It is public data that I can use to explore how different customer types are using Cyclistic bikes. We can consider the data to be Reliable, Original, Comprehensive, Current, and Cited (ROCCC) due to the anonymization and rigorous data handling practices outlined by Cyclistic. 

After downloading the datasets from the designated website, I organized them (.csv format) into a folder named "**CyclisticData2024**" 

Upon initial examination of the files, I observed that all of them had 13 columns of information which are: *ride_id, rideable_type, started_at, ended_at, start_station_name, start_station_id, end_station_name, end_station_id, start_lat, start_lng, end_lat, end_long, and member_casual*. This shows that the data are consistent throughout, which means the data is organized in a way that allows analysis of trends and patterns. 

## Process
I chose to use RStudio to clean, aggregate and analyze the large amount of monthly data I stored in the folder. 

### Setting up my environment
Before everything, I installed and loaded the "tidyverse" package. I also used the "conflicted" package to manage conflicts, setting dplyr: filter and dplyr: lag as the default choices. 

```{r set up2}
install.packages("tidyverse", repos = "http://cran.us.r-project.org")

library(tidyverse)

library(conflicted)

conflict_prefer("filter", "dplyr")
conflict_prefer("lag", "dplyr")
```

### Import Data
I imported the individual data files into new vectors first and then combine them later into a single dataset. 

```{r import data}
Jan_2024 <- read_csv("202401-divvy-tripdata.csv")
Feb_2024 <- read_csv("202402-divvy-tripdata.csv")
Mar_2024 <- read_csv("202403-divvy-tripdata.csv") 
Apr_2024 <- read_csv("202404-divvy-tripdata.csv")
May_2024 <- read_csv("202405-divvy-tripdata.csv")
Jun_2024 <- read_csv("202406-divvy-tripdata.csv")
Jul_2024 <- read_csv("202407-divvy-tripdata.csv")
Aug_2024 <- read_csv("202408-divvy-tripdata.csv")
Sep_2024 <- read_csv("202409-divvy-tripdata.csv")
Oct_2024 <- read_csv("202410-divvy-tripdata.csv")
Nov_2024 <- read_csv("202411-divvy-tripdata.csv")
Dec_2024 <- read_csv("202412-divvy-tripdata.csv")
```

### Data Validation
To ensure the accuracy and integrity, I verified the column names of all the new vectors I set up. This was necessary to see if the vectors were compatible with merging. I compared the column names ensuring they matched perfectly, regardless of their order.   

```{r data validation}
colnames(Jan_2024)
colnames(Feb_2024)
colnames(Mar_2024)
colnames(Apr_2024)
colnames(May_2024)
colnames(Jun_2024)
colnames(Jul_2024)
colnames(Aug_2024)
colnames(Sep_2024)
colnames(Oct_2024)
colnames(Nov_2024)
colnames(Dec_2024)
```

Upon validation, no errors regarding the data types of each column was observed. Thus, I proceeded to aggregate all the vectors into one dataset. 

### Aggregate Data
Combining the data from each month into one will allow a more efficient and comprehensive analysis. This makes it easier to identify trends and patterns across the entire dataset. 

```{r aggregate data}
all_trips <- bind_rows(Jan_2024,Feb_2024,Mar_2024,Apr_2024,May_2024,Jun_2024,Jul_2024,
                       Aug_2024,Sep_2024,Oct_2024,Nov_2024,Dec_2024)
```

After combining all the data, I also chose to save the data into a file on the hard drive. This ensures that the data is available for future reference. 

```{r backup aggregated data, eval=FALSE, include=TRUE}
write.csv(all_trips, file = "all_trips.csv", row.names = FALSE)
```

### Data Validation
After the aggregation, it is good to validate the data to ensure accuracy, completeness and consistency.

```{r data validation2}
str(all_trips)
View(head(all_trips))
summary(all_trips)
```

### Data Cleaning
To clean the data, I decided to check for duplicates and rows with null or "NA" values. 

```{r check for duplicates}
duplicates <- duplicated(all_trips)

num_duplicates <- sum(duplicates)

print(num_duplicates)
```

```{r check for null values}
colSums(is.na(all_trips))
```

No duplicates were found on the data. To ensure the integrity and reliability of the data, I decided to save new data frame without the rows with null values. After the removal, I also rechecked the new data for null values, just to be sure.  

```{r removing null}
clean_trips <- all_trips[complete.cases(all_trips),]

colSums(is.na(clean_trips))
```

Columns **"started_at"** and **"ended_at"** records date and time. Logically, **"started_at"** values should be lesser than that of the **"ended_at"**. Thus, I decided to filter out rows where this condition is not followed. This ensures that data is accurate and meaningful.

```{r removing outliers1}
clean_trips <- clean_trips %>% 
  filter(started_at < ended_at)
```

For clarity, I also decided to change a few column names. This involved renaming columns to names that would be more descriptive and properly reflect their content. 

```{r renaming columns}
clean_trips <- rename(clean_trips, rider_type = member_casual, bike_type = rideable_type)
```

To understand the duration of trip rides, I added a column **"ride_length"** to calculate it. The column is derived from subtracting **"started_at"** from **"ended_at"**. The results are in minutes.   

```{r add ride_length}
clean_trips$ride_length <- round((clean_trips$ended_at - clean_trips$started_at)/60, 2)

attr(clean_trips$ride_length, "units") <- "minutes"
```

To facilitate deeper analysis, I created additional columns for date and day of the week based on the **"started_at"** and **"ended_at"** column. The **"started_date"** column will allow plots to examine trends over time by day. The columns **"start_weekday"** and **"end_weekday"** were added for analysis of the specific day a trip happened and this was converted to a factor. 

```{r add started date}
clean_trips$started_date <- as.Date(clean_trips$started_at)
```

```{r add weekday cols}
clean_trips$start_weekday <- wday(clean_trips$started_at, label = TRUE)
clean_trips$end_weekday <- wday(clean_trips$ended_at, label = TRUE)

clean_trips$start_weekday <- as.factor(clean_trips$start_weekday)
clean_trips$end_weekday <- as.factor(clean_trips$end_weekday)
```

It was also necessary to remove excessively long rides and too short rides. I decided to limit the results to those rides that were between five minutes and two days long. 

```{r removing outliers2}
clean_trips <- clean_trips %>% 
  filter(ride_length <= 2880 & ride_length > 5)
```

To prepare for analysis, I decided to split the data into two groups: member and casual. 

```{r split}
member_trips <- clean_trips %>% 
  filter(rider_type == "member")

casual_trips <- clean_trips %>% 
  filter(rider_type == "casual")
```

## Analyze & Share
During the analysis phase, I explored the data to gain understanding of its trends and patterns. I created graphs, charts and a heat map to help visualize the data and identify trends. 

### Basic Metrics
From the basic metrics below, it seems that casual riders use Cyclistic bikes for longer periods compared to annual members. Given this valuable information, it would be worth exploring ways to encourage casual riders to become annual members given their high usage. It would also be important to study the reasons behind the high maximum ride lengths as this might lead to potential misuse or misunderstanding of rental policies. 

```{r compute basice metrics}
ride_length_mean_member <- mean(as.numeric(member_trips$ride_length))
ride_length_max_member <- max(as.numeric(member_trips$ride_length))
ride_length_min_member <- min(as.numeric(member_trips$ride_length))

ride_length_mean_casual <- mean(as.numeric(casual_trips$ride_length))
ride_length_max_casual <- max(as.numeric(casual_trips$ride_length))
ride_length_min_casual <- min(as.numeric(casual_trips$ride_length))
```

```{r metric df}
ride_length_metric <- data.frame(
  Metric = c("Mean", "Max", "Min"),
  Member = round(c(ride_length_mean_member, ride_length_max_member, ride_length_min_member), 2),
  Casual = round(c(ride_length_mean_casual, ride_length_max_casual, ride_length_min_casual), 2)
)

print(ride_length_metric)
```

### Daily Bike Usage
The graphs below shows the daily usage of bikes for the entire year of 2024, from January to December. As observed, there is a definitive seasonal trend for Cyclistic bike usage on both groups. Both groups' daily usage decline during Chicago winter months (December to February). It is noticeable that casual riders' usage go very flat during winter months but make up for it in volume during warmer months. It would be good to consider giving incentives for casual riders to convert as annual members during warmer months.

```{r daily bike usage data}
daily_rides_member <- member_trips %>% 
  group_by(started_date) %>% 
  summarise(count = n())

daily_rides_casual <- casual_trips %>% 
  group_by(started_date) %>% 
  summarise(count = n())
```

```{r daily bike usage plots}
ggplot(daily_rides_member, aes(x = started_date, y = count)) +
  geom_line(color = "darkorchid4") +
  geom_smooth(method = "loess", se = FALSE, color = "tomato3", linetype = "dashed") +
  labs(x = "Date", y = "Number of Rentals", title = "Daily Bike Rentals for Members",
       caption = "Source: https://divvybikes.com/system-data") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold", size = 20),
        plot.subtitle = element_text(face = "italic", size = 12),
        axis.title = element_text(face = "bold", size = 14),
        axis.text = element_text(size = 12))

ggplot(daily_rides_casual, aes(x = started_date, y = count)) +
  geom_line(color = "darkorchid4") +
  geom_smooth(method = "loess", se = FALSE, color = "tomato3", linetype = "dashed") +
  labs(x = "Date", y = "Number of Rentals", title = "Daily Bike Rentals for Casual",
       caption = "Source: https://divvybikes.com/system-data") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold", size = 20),
        plot.subtitle = element_text(face = "italic", size = 12),
        axis.title = element_text(face = "bold", size = 14),
        axis.text = element_text(size = 12))
```

### Overall Bike Preference
Looking at the graph below, both groups prefer classic bikes. Perhaps giving incentives around classic bikes should be considered to convert casual riders into becoming annual members.

Vast majority of bikes are classic and electric but it seems that Cyclistic has introduced electric scooters to their rentals. During the introduction of electric scooters, data shows that more casual riders used them compared to the annual members. More data on electric scooter usage and further study would be required in order to draw a viable conclusion.      

```{r bike preference data}
bike_type_member <- member_trips %>% 
  group_by(bike_type) %>% 
  summarise(count = n())

bike_type_casual <- casual_trips %>% 
  group_by(bike_type) %>% 
  summarise(count = n())

bike_pref <- rbind(
  mutate(bike_type_member, user_type = "Member"),
  mutate(bike_type_casual, user_type = "Casual")
)
```

```{r bike preference plot}
ggplot(bike_pref, aes(x = bike_type, y = count, fill = user_type)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_text(aes(label=count), vjust=-0.3, position = position_dodge(0.9))+
  labs(x = "Bike Type", y = "Count", fill = "User Type", title = "Bike Type Preference by User Type") +
  theme_minimal()
```

### Day and Time Preference
The heat maps below shows the day and time when most usage happens for both groups. 

Annual members' usage mostly happen Monday through Thursday during morning and at night. This suggests that annual members use Cyclistic as their mode of transport to work or school. 

For casual riders, most usage happen on the weekends and the usage are fairly consistent throughout other days. This suggests that casual riders use Cyclistic more for leisure rather than for work or school transportation. 

```{r heat maps data}
member_trips_hr <- member_trips %>% 
  mutate(hour = hour(started_at),
         day = wday(started_at, label = TRUE)) %>% 
  group_by(hour, day) %>% 
  summarise(freq = n())

casual_trips_hr <- casual_trips %>% 
  mutate(hour = hour(started_at),
         day = wday(started_at, label = TRUE)) %>% 
  group_by(hour, day) %>% 
  summarise(freq = n())
```

```{r heat maps}
ggplot(member_trips_hr, aes(x = day, y = hour, fill = freq)) +
  geom_tile(color = "white") +
  scale_fill_gradient(low = "lightpink", high = "red4") +
  labs(title = "Member Usage by Time and Day of Week",
       x = "Day of Week", y = "Hour of Day", fill = "Frequency") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))

ggplot(casual_trips_hr, aes(x = day, y = hour, fill = freq)) +
  geom_tile(color = "white") +
  scale_fill_gradient(low = "lightpink", high = "red4") +
  labs(title = "Casual Usage by Time and Day of Week",
       x = "Day of Week", y = "Hour of Day", fill = "Frequency") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))
```

### Bike Preferences Over Time
It is very clear that both groups choose to use classic bikes over electric bikes or electric scooters. It can also be noticed that during winter months the preference of classic bikes over electric bikes is only slightly high. Also, the usage of electric scooters is only for a short period of time which could mean that maybe Cyclistic only offered this service temporarily. 

```{r preference over time data}
daily_bike_pref <- clean_trips %>% 
  group_by(started_date, rider_type, bike_type) %>% 
  summarise(count = n()) %>% 
  ungroup()

member_daily_bike_pref <- daily_bike_pref %>% 
  filter(rider_type == "member")

casual_daily_bike_pref <- daily_bike_pref %>% 
  filter(rider_type == "casual")
```

```{r preference plot}
ggplot(member_daily_bike_pref, aes(x = started_date, y = count, color = bike_type)) +
  geom_line() + 
  labs(x = "Date", y = "Number of Rentals", color = "Bike Type", 
       title = "Daily Bike Type Preferences of Members") +
  theme_minimal()

ggplot(casual_daily_bike_pref, aes(x = started_date, y = count, color = bike_type)) +
  geom_line() + 
  labs(x = "Date", y = "Number of Rentals", color = "Bike Type", 
       title = "Daily Bike Type Preferences of Casual Users") +
  theme_minimal()
```

## Act

### Key Takeaways
* Annual members primarily use Cyclistic for commuting purposes, while casual riders tend to use it for leisure particularly on weekends and in warmer months. 
* Annual members have more consistent usage throughout the year compared to casual riders.
* Casual riders tend to have longer ride duration, averaging around 70% longer than annual members. 
* Casual riders have lower usage of services during winter months compared to annual members.

## Share

### Recommendation
* **Develop Seasonal Marketing Campaigns**: Use targeted advertising during warmer months and on weekends to highlight the benefits of membership, possibly offering seasonal discounts or promotional codes to give incentives to casual riders to convert into members.
* **Highlight Membership Benefits for Leisure and Commute**: Emphasize the membership cost-efficiency for weekday commuting to work or school and weekend convenience for leisure rides. 

